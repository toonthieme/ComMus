---
title: "Computational Musicology: The 27 Club"
author: "Anthony Thieme"
date: '`r Sys.Date()`'
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(spotifyr)
library(ggplot2)
```

### introduction
This project explores the music of the "27 Club," a group of influential musicians who all tragically passed away at the age of 27. The corpus includes Jimi Hendrix, Janis Joplin, Jim Morrison, Kurt Cobain, and Amy Winehouse, representing a range of musical styles from rock to soul. By analyzing their music's audio features from Spotify, we aim to uncover both differences and similarities in their work, potentially reflecting their personal struggles, artistic visions, and societal commentary.

```{r fetchin_data}

nirvana <- get_playlist_audio_features("","37i9dQZF1DZ06evO3M0Fbi")
hendrix <- get_playlist_audio_features("","37i9dQZF1DZ06evO4cWDcc")
joplin <- get_playlist_audio_features("","37i9dQZF1DZ06evO2Oo4IE")
winehouse <- get_playlist_audio_features("","37i9dQZF1DZ06evO42EWMo")
morrison <- get_playlist_audio_features("","37i9dQZF1DZ06evO19UBIk")

# Combine all tracks into one dataframe and add an artist column
tracks_combined <- bind_rows(
  nirvana %>% mutate(artist = "Nirvana"),
  hendrix %>% mutate(artist = "Jimi Hendrix"),
  joplin %>% mutate(artist = "Janis Joplin"),
  winehouse %>% mutate(artist = "Amy Winehouse"),
  morrison %>% mutate(artist = "Jim Morrison")
)

# Prepare the data by selecting relevant features and renaming appropriately
tracks_prepared <- tracks_combined %>%
  select(track.id, track.name, track.artists, artist, energy, valence, tempo, instrumentalness, danceability, acousticness, liveness, loudness, speechiness, time_signature, mode, key)



```

```{r}
# Energy vs. Valence Plot
ggplot(tracks_prepared, aes(x = valence, y = energy, color = artist)) +
  geom_point(alpha = 0.7) +
  theme_minimal() +
  labs(
    title = "Energy vs. Valence in Music of the '27 Club'",
    x = "Valence (Musical Positiveness)",
    y = "Energy (Intensity and Activity)",
    color = "Artist"
  ) +
  scale_color_brewer(palette = "Set2") +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    axis.title = element_text(size = 12),
    legend.title = element_text(size = 12),
    legend.position = "right"
  )
```



##**Energy and Valence**: 
This plot compares the energy and valence of tracks by different artists in the "27 Club". It helps in understanding the mood and intensity of their music.

## Danceability and Acousticness: 
This plot helps to explore how danceable and acoustic the compositions of the "27 Club" artists are, potentially indicating their style's intensity and texture.

```{r}
# Danceability vs. Acousticness Plot
ggplot(tracks_prepared, aes(x = danceability, y = acousticness, color = artist)) +
  geom_point(alpha = 0.6) +
  theme_minimal() +
  labs(
    title = "Danceability vs. Acousticness in '27 Club' Music",
    x = "Danceability",
    y = "Acousticness",
    color = "Artist"
  ) +
  scale_color_brewer(palette = "Set3") +
  theme(legend.position = "right")

```

## Loudness and Tempo: 
To understand the dynamic range and pace, which can contribute to the perceived intensity of their music.

``` {r}
# Loudness vs. Tempo Plot
ggplot(tracks_prepared, aes(x = tempo, y = loudness, color = artist)) +
  geom_point(alpha = 0.6) +
  theme_minimal() +
  labs(
    title = "Loudness vs. Tempo in '27 Club' Music",
    x = "Tempo (BPM)",
    y = "Loudness (dB)",
    color = "Artist"
  ) +
  scale_color_brewer(palette = "Set1") +
  theme(legend.position = "right")

```

## strumentalness and Liveness: 
This plot examines the focus on instrumental music versus live recordings among "27 Club" artists, reflecting their preferences for studio precision or live performance energy.
``` {r}
# Instrumentalness vs. Liveness Plot
ggplot(tracks_prepared, aes(x = instrumentalness, y = liveness, color = artist)) +
  geom_point(alpha = 0.6) +
  theme_minimal() +
  labs(
    title = "Instrumentalness vs. Liveness in '27 Club' Music",
    x = "Instrumentalness",
    y = "Liveness",
    color = "Artist"
  ) +
  scale_color_brewer(palette = "Set2") +
  theme(legend.position = "right")

```


```{r}
ggplot(tracks_prepared, aes(x = artist, y = energy, fill = artist)) +
  geom_violin() +
  labs(title = "Energy Distribution by Artist", x = "Artist", y = "Energy") +
  theme_light() +
  scale_fill_brewer(palette = "Pastel1")

```

```{r}

ggplot(tracks_prepared, aes(x = artist, y = valence, color = artist)) +
  geom_boxplot() +
  labs(title = "Valence Range by Artist", x = "Artist", y = "Valence") +
  theme_minimal() +
  scale_color_brewer(palette = "Set3")



```


```{r}
tracks_prepared <- tracks_prepared %>%
  mutate(mode = ifelse(mode == 0, "Minor", "Major"))  # Convert mode from numeric to a more readable format

ggplot(tracks_prepared, aes(x = valence, y = energy, size = loudness, color = mode)) +
  geom_point() +
  geom_rug(sides = "b", alpha = 0.5) +  # Bottom side rugs for valence
  geom_rug(sides = "l", alpha = 0.5) +  # Left side rugs for energy
  theme_light() +
  labs(
    title = "Musical Features by Mode in '27 Club' Music",
    x = "Valence",
    y = "Energy",
    color = "Mode",
    size = "Loudness"
  ) +
  scale_color_brewer(palette = "Set1") +
  scale_size(range = c(1, 5))  # Adjusting point size scale for visibility

```


```{r}
ggplot(tracks_prepared, aes(x = valence, y = energy, color = as.factor(key))) +
  geom_point(alpha = 0.7) +
  facet_wrap(~artist, scales = "free", ncol = 2) +  # Adjust `ncol` for layout preferences
  theme_minimal() +
  labs(
    title = "Energy vs. Valence Colored by Mutsical Key, Faceted by Artist",
    x = "Valence",
    y = "Energy",
    color = "Key"
  ) +
  scale_color_brewer(palette = "Paired", type = "qual", direction = 1) +
  theme(legend.position = "right")


```


```{r}
ggplot(tracks_prepared, aes(x = valence, y = energy)) +
  geom_point(aes(color = as.factor(key)), alpha = 0.7) +
  geom_text(aes(label = paste(artist, key, sep = ", ")), check_overlap = TRUE, vjust = -1, size = 2.5) +
  theme_minimal() +
  labs(
    title = "Energy vs. Valence with Key and Artist Labels",
    x = "Valence",
    y = "Energy",
    color = "Key"
  ) +
  scale_color_brewer(palette = "Set3") +
  theme(legend.position = "bottom")


```

```{r}

ggplot(tracks_prepared, aes(x = as.factor(key), y = energy, fill = as.factor(key))) +
  geom_boxplot() +
  facet_wrap(~composer, scales = "free_y") +
  theme_minimal() +
  labs(
    title = "Distribution of Energy by Key and Composer",
    x = "Key",
    y = "Energy",
    fill = "Key"
  ) +
  scale_fill_brewer(palette = "Spectral") +
  theme(legend.position = "none")  # Hide legend if redundant


```